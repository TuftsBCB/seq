package seq

// SubstMatrix corresponds to a substitution matrix and an alphabet that is
// used in sequence alignment algorithms. The matrix given should be square,
// with rows and columns equivalent to the length of the alphabet. (This means
// that if your substitution matrix includes gap penalties, then the alphabet
// should also have a gap character.)
type SubstMatrix struct {
	Alphabet Alphabet
	Scores   [][]int
}

var (
	identity = [][]int{
		{
			2, -1, -1, -1, 0, 0,
		},
		{
			-1, 2, -1, -1, 0, 0,
		},
		{
			-1, -1, 2, -1, 0, 0,
		},
		{
			-1, -1, -1, 2, 0, 0,
		},
		{
			0, 0, 0, 0, 0, 0,
		},
		{
			0, 0, 0, 0, 0, 0,
		},
	}

	// A standard BLOSUM62 substitution matrix for amino acid sequences.
	SubstBlosum62 = SubstMatrix{AlphaBlosum62, blosum62}

	// An identity substitution matrix for DNA sequences.
	SubstDNA = SubstMatrix{AlphaDNA, identity}

	// An identity substitution matrix for DNA sequences.
	SubstRNA = SubstMatrix{AlphaRNA, identity}
)

// The indices correspond to alpha62, and can be retrieved using the
// alpha62map. The last element in each column/row is the gap penalty.
var blosum62 = [][]int{
	{
		4.0, -2.0, 0.0, -2.0, -1.0, -2.0, 0.0, -2.0, -1.0, -1.0, -1.0, -1.0,
		-2.0, -1.0, -1.0, -1.0, 1.0, 0.0, 0.0, -3.0, 0.0, -2.0, -1.0, -4.0,
	},
	{
		-2.0, 4.0, -3.0, 4.0, 1.0, -3.0, -1.0, 0.0, -3.0, 0.0, -4.0, -3.0, 3.0,
		-2.0, 0.0, -1.0, 0.0, -1.0, -3.0, -4.0, -1.0, -3.0, 1.0, -4.0,
	},
	{
		0.0, -3.0, 9.0, -3.0, -4.0, -2.0, -3.0, -3.0, -1.0, -3.0, -1.0, -1.0,
		-3.0, -3.0, -3.0, -3.0, -1.0, -1.0, -1.0, -2.0, -2.0, -2.0, -3.0, -4.0,
	},
	{
		-2.0, 4.0, -3.0, 6.0, 2.0, -3.0, -1.0, -1.0, -3.0, -1.0, -4.0, -3.0,
		1.0, -1.0, 0.0, -2.0, 0.0, -1.0, -3.0, -4.0, -1.0, -3.0, 1.0, -4.0,
	},
	{
		-1.0, 1.0, -4.0, 2.0, 5.0, -3.0, -2.0, 0.0, -3.0, 1.0, -3.0, -2.0, 0.0,
		-1.0, 2.0, 0.0, 0.0, -1.0, -2.0, -3.0, -1.0, -2.0, 4.0, -4.0,
	},
	{
		-2.0, -3.0, -2.0, -3.0, -3.0, 6.0, -3.0, -1.0, 0.0, -3.0, 0.0, 0.0,
		-3.0, -4.0, -3.0, -3.0, -2.0, -2.0, -1.0, 1.0, -1.0, 3.0, -3.0, -4.0,
	},
	{
		0.0, -1.0, -3.0, -1.0, -2.0, -3.0, 6.0, -2.0, -4.0, -2.0, -4.0, -3.0,
		0.0, -2.0, -2.0, -2.0, 0.0, -2.0, -3.0, -2.0, -1.0, -3.0, -2.0, -4.0,
	},
	{
		-2.0, 0.0, -3.0, -1.0, 0.0, -1.0, -2.0, 8.0, -3.0, -1.0, -3.0, -2.0,
		1.0, -2.0, 0.0, 0.0, -1.0, -2.0, -3.0, -2.0, -1.0, 2.0, 0.0, -4.0,
	},
	{
		-1.0, -3.0, -1.0, -3.0, -3.0, 0.0, -4.0, -3.0, 4.0, -3.0, 2.0, 1.0,
		-3.0, -3.0, -3.0, -3.0, -2.0, -1.0, 3.0, -3.0, -1.0, -1.0, -3.0, -4.0,
	},
	{
		-1.0, 0.0, -3.0, -1.0, 1.0, -3.0, -2.0, -1.0, -3.0, 5.0, -2.0, -1.0,
		0.0, -1.0, 1.0, 2.0, 0.0, -1.0, -2.0, -3.0, -1.0, -2.0, 1.0, -4.0,
	},
	{
		-1.0, -4.0, -1.0, -4.0, -3.0, 0.0, -4.0, -3.0, 2.0, -2.0, 4.0, 2.0,
		-3.0, -3.0, -2.0, -2.0, -2.0, -1.0, 1.0, -2.0, -1.0, -1.0, -3.0, -4.0,
	},
	{
		-1.0, -3.0, -1.0, -3.0, -2.0, 0.0, -3.0, -2.0, 1.0, -1.0, 2.0, 5.0,
		-2.0, -2.0, 0.0, -1.0, -1.0, -1.0, 1.0, -1.0, -1.0, -1.0, -1.0, -4.0,
	},
	{
		-2.0, 3.0, -3.0, 1.0, 0.0, -3.0, 0.0, 1.0, -3.0, 0.0, -3.0, -2.0, 6.0,
		-2.0, 0.0, 0.0, 1.0, 0.0, -3.0, -4.0, -1.0, -2.0, 0.0, -4.0,
	},
	{
		-1.0, -2.0, -3.0, -1.0, -1.0, -4.0, -2.0, -2.0, -3.0, -1.0, -3.0, -2.0,
		-2.0, 7.0, -1.0, -2.0, -1.0, -1.0, -2.0, -4.0, -2.0, -3.0, -1.0, -4.0,
	},
	{
		-1.0, 0.0, -3.0, 0.0, 2.0, -3.0, -2.0, 0.0, -3.0, 1.0, -2.0, 0.0, 0.0,
		-1.0, 5.0, 1.0, 0.0, -1.0, -2.0, -2.0, -1.0, -1.0, 3.0, -4.0,
	},
	{
		-1.0, -1.0, -3.0, -2.0, 0.0, -3.0, -2.0, 0.0, -3.0, 2.0, -2.0, -1.0,
		0.0, -2.0, 1.0, 5.0, -1.0, -1.0, -3.0, -3.0, -1.0, -2.0, 0.0, -4.0,
	},
	{
		1.0, 0.0, -1.0, 0.0, 0.0, -2.0, 0.0, -1.0, -2.0, 0.0, -2.0, -1.0, 1.0,
		-1.0, 0.0, -1.0, 4.0, 1.0, -2.0, -3.0, 0.0, -2.0, 0.0, -4.0,
	},
	{
		0.0, -1.0, -1.0, -1.0, -1.0, -2.0, -2.0, -2.0, -1.0, -1.0, -1.0, -1.0,
		0.0, -1.0, -1.0, -1.0, 1.0, 5.0, 0.0, -2.0, 0.0, -2.0, -1.0, -4.0,
	},
	{
		0.0, -3.0, -1.0, -3.0, -2.0, -1.0, -3.0, -3.0, 3.0, -2.0, 1.0, 1.0,
		-3.0, -2.0, -2.0, -3.0, -2.0, 0.0, 4.0, -3.0, -1.0, -1.0, -2.0, -4.0,
	},
	{
		-3.0, -4.0, -2.0, -4.0, -3.0, 1.0, -2.0, -2.0, -3.0, -3.0, -2.0, -1.0,
		-4.0, -4.0, -2.0, -3.0, -3.0, -2.0, -3.0, 11.0, -2.0, 2.0, -3.0, -4.0,
	},
	{
		0.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0,
		-1.0, -2.0, -1.0, -1.0, 0.0, 0.0, -1.0, -2.0, -1.0, -1.0, -1.0, -4.0,
	},
	{
		-2.0, -3.0, -2.0, -3.0, -2.0, 3.0, -3.0, 2.0, -1.0, -2.0, -1.0, -1.0,
		-2.0, -3.0, -1.0, -2.0, -2.0, -2.0, -1.0, 2.0, -1.0, 7.0, -2.0, -4.0,
	},
	{
		-1.0, 1.0, -3.0, 1.0, 4.0, -3.0, -2.0, 0.0, -3.0, 1.0, -3.0, -1.0, 0.0,
		-1.0, 3.0, 0.0, 0.0, -1.0, -2.0, -3.0, -1.0, -2.0, 4.0, -4.0,
	},
	{
		-4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0,
		-4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0,
	},
}
